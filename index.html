!DOCTYPE html
!-- saved from url=(0041)fileCUsersAdminDesktopindex.html --
html lang=zh-Hantheadmeta http-equiv=Content-Type content=texthtml; charset=UTF-8
  
  meta name=viewport content=width=device-width, initial-scale=1.0
  title收拾家中物品歸位title
  style
    root{
      --bg #0f172a;            slate-900 
      --panel #111827cc;       gray-90080 
      --accent #22c55e;        green-500 
      --accent-2 #60a5fa;      blue-400 
      --text #e5e7eb;          gray-200 
      --muted #94a3b8;         slate-400 
      --bad #ef4444;           red-500 
      --good #10b981;          emerald-500 
      --card #0b1220;          deep panel 
      --drop #1f2937;          gray-800 
      --shadow 0 10px 30px rgba(0,0,0,.45);
      --radius 18px;
    }
    {box-sizingborder-box}
    html,body{height100%}
    body{
      margin0; background radial-gradient(1200px 800px at 80% -10%, #132035 0%, var(--bg) 55%);
      colorvar(--text); font-family ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, PingFang TC, Heiti TC, Arial, Apple Color Emoji, Segoe UI Emoji;
      displayflex; flex-directioncolumn; gap12px;
    }
    header{
      displaygrid; grid-template-columns 1fr auto auto auto; gap10px; align-itemscenter;
      padding12px 16px; positionsticky; top0; z-index20;
      backgroundlinear-gradient(180deg, rgba(17,24,39,.95), rgba(17,24,39,.55));
      backdrop-filter blur(6px);
      box-shadow var(--shadow);
    }
    .title{font-weight800; letter-spacing.5px;}
    .pill{displayinline-flex; align-itemscenter; gap8px; padding6px 10px; background#111827; border1px solid #1f2937; border-radius999px; box-shadow inset 0 0 0 1px #0b1220;}
    .pill b{font-variant-numeric tabular-nums}
    .btn{
      bordernone; padding10px 14px; border-radius14px; font-weight700; cursorpointer; color#0b1220;
      box-shadow var(--shadow); transition transform .08s ease, filter .2s ease; user-selectnone;
    }
    .btnactive{ transform translateY(1px) }
    .btn-primary{ backgroundlinear-gradient(180deg, #34d399, #10b981); }
    .btn-muted{ backgroundlinear-gradient(180deg, #93c5fd, #60a5fa); }
    .btn-danger{ backgroundlinear-gradient(180deg, #f87171, #ef4444); colorwhite }
    .wrap{max-width1100px; width100%; margin0 auto; padding0 16px 20px; displaygrid; gap12px}

     Game board 
    .board{ displaygrid; grid-template-columns repeat(12, 1fr); grid-auto-rows 120px; gap12px; }
    .room{ background linear-gradient(180deg, #111827, #0b1220); border1px solid #1f2937; border-radius var(--radius); positionrelative; overflowhidden; box-shadow var(--shadow);}
    .room h3{ positionabsolute; left12px; top10px; margin0; font-size14px; colorvar(--muted); font-weight700; letter-spacing.5px }
    .room .icon{ positionabsolute; right10px; bottom8px; font-size28px; opacity.5 }
    .dropzone{ positionabsolute; inset0; border2px dashed transparent; border-radius inherit; displayflex; align-itemscenter; justify-contentcenter; color#64748b; font-weight700; letter-spacing.5px }
    .room.active .dropzone{ border-color#334155; backgroundrgba(99,102,241,.06)}
    .room.correct{ outline2px solid var(--good) }
    .room.wrong{ outline2px solid var(--bad) }

     Rooms layout 
    #room-living{ grid-column span 6 }
    #room-kitchen{ grid-column span 6 }
    #room-bedroom{ grid-column span 4 }
    #room-bath{ grid-column span 4 }
    #room-study{ grid-column span 4 }

     Staging area 
    .tray{ margin-top4px; displaygrid; grid-template-columns repeat(auto-fill, minmax(90px, 1fr)); gap10px }
    .card{ backgroundlinear-gradient(180deg, #0b1220, #0a1020); border1px solid #1f2937; border-radius 16px; padding10px; min-height90px; displayflex; align-itemscenter; justify-contentcenter; positionrelative; box-shadow var(--shadow);
      transition transform .15s ease, box-shadow .2s ease; cursorgrab; user-selectnone }
    .cardactive{ cursorgrabbing }
    .card.dragging{ transform scale(1.04) rotate(-1.5deg); z-index50; box-shadow 0 20px 50px rgba(0,0,0,.6) }

     HUD & dialogs 
    .hud{ displayflex; gap10px; flex-wrapwrap; align-itemscenter }
    .hint{ colorvar(--muted); font-size13px }
    .toast{ positionfixed; left50%; top16px; transformtranslateX(-50%); background#111827; colorvar(--text); padding10px 14px; border-radius999px; border1px solid #1f2937; box-shadow var(--shadow); displaynone }
    .progress{ height10px; background#0b1220; border1px solid #1f2937; border-radius999px; overflowhidden; box-shadow inset 0 0 0 1px #0a0f1d }
    .progress  div{ height100%; width0%; background linear-gradient(90deg, #34d399, #60a5fa); transition width .3s ease }

    .modal{ positionfixed; inset0; displaynone; align-itemscenter; justify-contentcenter; backgroundrgba(2,6,23,.65); backdrop-filter blur(4px); z-index80 }
    .modal .panel{ background linear-gradient(180deg, #0d1426, #0b1220); border1px solid #1f2937; border-radius22px; padding20px; max-width520px; widthmin(92vw, 520px); box-shadow var(--shadow) }
    .panel h2{ margin0 0 12px; }
    .panel p{ margin8px 0; colorvar(--muted) }
    .panel .actions{ displayflex; gap10px; justify-contentflex-end; margin-top12px }
    
     NEW styles for glowing effect 
    .glowing {
        animation glow 1s infinite alternate;
    }
    @keyframes glow {
        from {
            box-shadow 0 0 8px 0px rgba(96,165,250,.8);
        }
        to {
            box-shadow 0 0 16px 8px rgba(96,165,250,.6);
        }
    }

     Mobile tweaks 
    @media (max-width 860px){
      .board{ grid-auto-rows 110px }
      #room-living, #room-kitchen, #room-bedroom, #room-bath, #room-study{ grid-column span 12 }
    }
  style
head
body
  header class=wrap
    div class=title🏠 收拾家中物品歸位 span style=colorvar(--muted); font-weight600; font-size13px— 拖曳物品到正確房間spandiv
    div class=pill id=level-pill等級 b id=level1bdiv
    div class=pill得分 b id=score0bdiv
    div class=pill時間 b id=time47bsdiv
  header

  main class=wrap
    section class=hud
      button class=btn btn-primary id=startBtn開始  下一關button
      button class=btn btn-muted id=hintBtn提示button
      button class=btn btn-danger id=resetBtn重置button
      div class=progress style=flex1 1 220px; min-width220pxdiv id=progressBar style=width 0%;divdiv
      div class=hint滑鼠拖曳或用鍵盤 kbdTabkbd 選取、kbdEnterkbd 拿起、kbd方向鍵kbd 選房間、kbdEnterkbd 放下。div
    section

    !-- Rooms board --
    section class=board aria-label=房間
      div class=room id=room-living data-room=客廳 tabindex=0 aria-label=客廳，放置區
        h3客廳h3div class=icon🛋️div
        div class=dropzone拖到這裡div
      div
      div class=room id=room-kitchen data-room=廚房 tabindex=0 aria-label=廚房，放置區
        h3廚房h3div class=icon🍳div
        div class=dropzone拖到這裡div
      div
      div class=room id=room-bedroom data-room=臥室 tabindex=0 aria-label=臥室，放置區
        h3臥室h3div class=icon🛏️div
        div class=dropzone拖到這裡div
      div
      div class=room id=room-bath data-room=浴室 tabindex=0 aria-label=浴室，放置區
        h3浴室h3div class=icon🛁div
        div class=dropzone拖到這裡div
      div
      div class=room id=room-study data-room=書房 tabindex=0 aria-label=書房，放置區
        h3書房h3div class=icon📚div
        div class=dropzone拖到這裡div
      div
    section

    !-- Items tray --
    h3 style=margin14px 2px 0; colorvar(--muted)雜亂區（請整理）：h3
    section class=tray id=tray aria-live=politediv class=card role=button aria-grabbed=false tabindex=0 data-room=客廳span class=emoji aria-hidden=true📺spanspan class=name遙控器spandivdiv class=card role=button aria-grabbed=false tabindex=0 data-room=書房span class=emoji aria-hidden=true✏️spanspan class=name鉛筆spandivdiv class=card role=button aria-grabbed=false tabindex=0 data-room=浴室span class=emoji aria-hidden=true🧴spanspan class=name洗髮精spandivdiv class=card role=button aria-grabbed=false tabindex=0 data-room=客廳span class=emoji aria-hidden=true🛋️spanspan class=name靠枕spandivdiv class=card role=button aria-grabbed=false tabindex=0 data-room=廚房span class=emoji aria-hidden=true🍳spanspan class=name鍋子spandivdiv class=card role=button aria-grabbed=false tabindex=0 data-room=浴室span class=emoji aria-hidden=true🪥spanspan class=name牙刷spandivsection

  main

  div class=toast id=toast role=status aria-live=politediv

  !-- Modals --
  div class=modal id=startModal aria-modal=true role=dialog style=display none;
    div class=panel
      h2準備好了嗎？h2
      p將物品拖曳到正確的房間。全部正確即可過關！p
      ul style=margin8px 0; padding-left18px; colorvar(--muted)
        li每回合都有時間限制，等級越高時間越少。li
        li連續正確有連擊加成，失誤會扣分與連擊。li
        li按「提示」可高亮 1 個正確房間（不扣分）。li
      ul
      div class=actions
        button class=btn btn-primary id=startGame開始遊戲button
      div
    div
  div

  div class=modal id=endModal aria-modal=true role=dialog style=display none;
    div class=panel
      h2 id=endTitle時間到！h2
      p id=endText本關得分：b0bbr最佳紀錄：b0bbr還剩 b6b 個物品未整理。p
      div class=actions
        button class=btn btn-muted id=retryBtn再試一次button
        button class=btn btn-primary id=nextBtn下一關button
      div
    div
  div

  script
     --- 遊戲資料 ---
    const ITEM_POOL = [
      { name遙控器, emoji🕹️, room客廳 },
      { name沙發, emoji🛋️, room客廳 },
      { name玩具車, emoji🚗, room客廳 },
      { name鍋子, emoji🍳, room廚房 },
      { name湯匙, emoji🥄, room廚房 },
      { name盤子, emoji🍽️, room廚房 },
      { name枕頭, emoji🛏️, room臥室 },
      { name衣服, emoji👕, room臥室 },
      { name鬧鐘, emoji⏰, room臥室 },
      { name牙刷, emoji🪥, room浴室 },
      { name毛巾, emoji🧻, room浴室 },
      { name洗髮精, emoji🧴, room浴室 },
      { name筆電, emoji💻, room書房 },
      { name書本, emoji📖, room書房 },
      { name鉛筆, emoji✏️, room書房 },
    ];

    const ROOMS = [客廳,廚房,臥室,浴室,書房];

     --- 遊戲狀態 ---
    const state = {
      level 1,
      score 0,
      combo 0,
      timeLeft 60,
      timer null,
      roundItems [],
      picked null,  目前拿起的卡片元素
      keyboardMode false,
    };

     --- 元素參考 ---
    const tray = document.getElementById('tray');
    const rooms = Array.from(document.querySelectorAll('.room'));
    const scoreEl = document.getElementById('score');
    const levelEl = document.getElementById('level');
    const timeEl = document.getElementById('time');
    const progressBar = document.getElementById('progressBar');
    const toast = document.getElementById('toast');
    
    const startModal = document.getElementById('startModal');
    const endModal = document.getElementById('endModal');
    const endTitle = document.getElementById('endTitle');
    const endText = document.getElementById('endText');

     --- 工具函式 ---
    const randInt = (a,b)= Math.floor(Math.random()(b-a+1))+a;
    const sample = (arr,n)= arr.slice().sort(()=Math.random()-.5).slice(0,n);

    function showToast(msg){
      toast.textContent = msg; toast.style.display='block';
      clearTimeout(showToast._t);
      showToast._t = setTimeout(()= toast.style.display='none', 900);
    }

    function updateHUD(){
      scoreEl.textContent = state.score;
      levelEl.textContent = state.level;
      timeEl.textContent = state.timeLeft;
      const total = levelTargetCount();
      const done = total - tray.querySelectorAll('.card').length;
      progressBar.style.width = Math.max(0, Math.min(100, Math.round(donetotal100))) + '%';
    }

    function levelTargetCount(){
       每關需整理的物品數，會隨等級增加
      return Math.min(14, 6 + Math.floor((state.level-1)1.5));
    }
    function levelTime(){
       時間逐關遞減
      return Math.max(25, 60 - (state.level-1)3);
    }

    function buildRound(){
      tray.innerHTML = '';
      state.roundItems = sample(ITEM_POOL, levelTargetCount());
      state.roundItems.forEach((it,i)={
        const card = document.createElement('div');
        card.className = 'card';
        card.setAttribute('role','button');
        card.setAttribute('aria-grabbed','false');
        card.setAttribute('tabindex','0');
        card.dataset.room = it.room;
        card.dataset.name = it.name;  Store name for lore
        card.dataset.emoji = it.emoji;  Store emoji for lore
        card.innerHTML = `span class=emoji aria-hidden=true${it.emoji}spanspan class=name${it.name}span`;

         Pointer drag
        card.addEventListener('pointerdown', onDragStart);
        tray.appendChild(card);
      });
      updateHUD();
    }
    
     --- 拖曳邏輯（滑鼠觸控） ---
    let dragging = null, startX=0,startY=0, oX=0,oY=0;
    function onDragStart(e){
      if(e.button!==0 && e.pointerType==='mouse') return;
      dragging = e.currentTarget; dragging.classList.add('dragging'); dragging.setPointerCapture(e.pointerId);
      const rect = dragging.getBoundingClientRect();
      startX = e.clientX; startY = e.clientY; oX = rect.left; oY = rect.top;
      Object.assign(dragging.style, { position'fixed', leftrect.left+'px', toprect.top+'px', widthrect.width+'px', heightrect.height+'px'});
      rooms.forEach(r= r.classList.add('active'));
      dragging.addEventListener('pointermove', onDragMove);
      dragging.addEventListener('pointerup', onDragEnd);
    }
    function onDragMove(e){
      if(!dragging) return;
      const dx = e.clientX - startX, dy = e.clientY - startY;
      dragging.style.left = (oX+dx)+ 'px';
      dragging.style.top = (oY+dy)+ 'px';
    }
    function onDragEnd(e){
      if(!dragging) return;
      rooms.forEach(r= r.classList.remove('active'));
      const drop = rooms.find(r= isOver(dragging, r));
      if(drop){
        tryPlace(dragging, drop);
      }else{
         回到原處
        dragging.style.position=''; dragging.style.left=''; dragging.style.top=''; dragging.style.width=''; dragging.style.height='';
      }
      dragging.classList.remove('dragging');
      dragging.removeEventListener('pointermove', onDragMove);
      dragging.removeEventListener('pointerup', onDragEnd);
      dragging.releasePointerCapture(e.pointerId);
      dragging = null;
    }
    function isOver(a,b){
      const ra = a.getBoundingClientRect();
      const rb = b.getBoundingClientRect();
      const cx = ra.left + ra.width2; const cy = ra.top + ra.height2;
      return cx=rb.left && cx=rb.right && cy=rb.top && cy=rb.bottom;
    }

     --- 鍵盤操作（無滑鼠可玩） ---
    document.addEventListener('keydown', (e)={
      const active = document.activeElement;
      if(active && active.classList.contains('card')){
        if(e.key==='Enter'){
          if(state.picked===active){  放下：嘗試放至聚焦的房間
            const focusRoom = rooms.find(r= r.matches('focus'));
            if(focusRoom) tryPlace(active, focusRoom);
          }else{
            state.picked = active; active.setAttribute('aria-grabbed','true'); showToast('選擇了「'+active.querySelector('.name').textContent+'」');
          }
          e.preventDefault();
        }
      }
      if(e.key==='Escape' && state.picked){ state.picked.setAttribute('aria-grabbed','false'); state.picked=null; }
    });

     --- 核對放置 ---
    function tryPlace(card, roomEl){
      const need = card.dataset.room;
      const got = roomEl.dataset.room;
      if(need===got){
        correct(card, roomEl);
      }else{
        wrong(card, roomEl);
      }
      updateHUD();
    }

    function correct(card, roomEl){
       檢查物品是否因為提示而歸位
      if (card.dataset.hinted === 'true') {
         提示物品，不加分，不計入連擊
        state.combo = 0;  即使在提示後，正確放置仍會中斷連擊
        flashRoom(roomEl, true);
        showToast(`✔ 成功歸位！ (提示物品，不計分或連擊)`);
      } else {
         正常歸位
        state.combo++;
        const gain = 100 + (state.combo-1)15;  連擊加成
        state.score += gain;
        flashRoom(roomEl, true);
        showToast(`✔ 正確！+${gain} 分（連擊 x${state.combo}）`);
      }
      
      card.remove();
      checkEnd();
    }

    function wrong(card, roomEl){
      state.combo = 0;
      const loss = 50;
      state.score = Math.max(0, state.score - loss);
      flashRoom(roomEl, false);
      showToast(`✖ 房間錯了… -${loss} 分`);
       回位
      card.style.position=''; card.style.left=''; card.style.top=''; card.style.width=''; card.style.height='';
    }
    function flashRoom(roomEl, ok){
      roomEl.classList.add(ok 'correct''wrong');
      setTimeout(()= roomEl.classList.remove('correct','wrong'), 350);
    }

     --- 關卡流程 ---
    function startLevel(){
      state.combo = 0;
      state.timeLeft = levelTime();
      timeEl.textContent = state.timeLeft;
      clearInterval(state.timer);
      state.timer = setInterval(()={
        state.timeLeft--; timeEl.textContent = state.timeLeft;
        if(state.timeLeft=0){ clearInterval(state.timer); openEnd(false); }
      }, 1000);
      buildRound();
      hide(startModal); hide(endModal);
    }

    function openEnd(win){
      clearInterval(state.timer);
      const remain = tray.querySelectorAll('.card').length;
      endTitle.textContent = win '太棒了，過關！'  '時間到！';
      const best = Number(localStorage.getItem('tidyBest')0);
      if(state.scorebest) localStorage.setItem('tidyBest', state.score);
      endText.innerHTML = `本關得分：b${state.score}bbr最佳紀錄：b${Math.max(best, state.score)}bbr${win '準備挑戰更高等級吧！' `還剩 b${remain}b 個物品未整理。`}`;
      show(endModal);
    }

    function checkEnd(){
      if(tray.children.length===0){
        openEnd(true);
      }
    }

     --- UI 綁定 ---
    document.getElementById('startBtn').addEventListener('click', ()= show(startModal));
    document.getElementById('startGame').addEventListener('click', startLevel);
    document.getElementById('retryBtn').addEventListener('click', ()={ hide(endModal); startLevel(); });
    document.getElementById('nextBtn').addEventListener('click', ()={
      state.level++; levelEl.textContent = state.level; hide(endModal); startLevel();
    });
    document.getElementById('resetBtn').addEventListener('click', ()={
      state.level = 1; state.score = 0; levelEl.textContent = 1; updateHUD(); show(startModal);
    });
    
     提示功能：現在會重置連擊數並為物品加上標記
    document.getElementById('hintBtn').addEventListener('click', ()={
      if(tray.children.length===0) return;

       點擊提示時，立即將連擊數歸零
      state.combo = 0;
      updateHUD();  更新介面顯示
      
      const target = tray.children[randInt(0, tray.children.length-1)];
      const roomName = target.dataset.room;
      const roomEl = rooms.find(r= r.dataset.room===roomName);
      
       為物品加上提示標記
      target.dataset.hinted = 'true';
      
       高亮物品和房間
      pulse(roomEl);
      pulse(target);
      
      showToast(`提示：${roomName} (連擊已重置)`);
    });

    function pulse(el){
        el.classList.add('glowing');
        setTimeout(() = {
            el.classList.remove('glowing');
        }, 1000);
    }

    function show(el){ el.style.display='flex'; }
    function hide(el){ el.style.display='none'; }

     初始顯示說明
    show(startModal);
    updateHUD();
  script
bodyhtml
